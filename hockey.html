<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=3.0, user-scalable=yes">
<title>üèí GER vs USA ‚Äî Where They Play</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&display=swap');
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body {
    font-family: 'Inter', sans-serif;
    background: #0a0e1a;
    color: #fff;
    height: 100vh;
    overflow: hidden;
    touch-action: pan-x pan-y pinch-zoom;
  }

  /* Top bar */
  .top-bar {
    position: fixed;
    top: 0; left: 0; right: 0;
    z-index: 200;
    background: rgba(10, 14, 26, 0.95);
    backdrop-filter: blur(10px);
    padding: 8px 12px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    border-bottom: 1px solid #1a1e2e;
  }
  .score { font-size: 16px; font-weight: 900; letter-spacing: 2px; }
  .toggle-pills {
    display: flex;
    gap: 0;
  }
  .pill {
    padding: 6px 16px;
    font-size: 12px;
    font-weight: 700;
    border: none;
    cursor: pointer;
    text-transform: uppercase;
    letter-spacing: 1px;
    transition: all 0.2s;
  }
  .pill.ger { background: #222; color: #888; border-radius: 6px 0 0 6px; }
  .pill.usa { background: #222; color: #888; border-radius: 0 6px 6px 0; }
  .pill.both { background: #222; color: #888; border-radius: 0; }
  .pill.active.ger { background: #dd0000; color: #ffcc00; }
  .pill.active.usa { background: #002868; color: #fff; }
  .pill.active.both { background: #444; color: #fff; }

  /* Map container */
  .map-viewport {
    width: 100%;
    height: 100%;
    overflow: auto;
    padding-top: 52px;
    -webkit-overflow-scrolling: touch;
  }
  .map-canvas {
    position: relative;
    width: 1400px;
    height: 800px;
    background: #0a0e1a;
  }

  /* SVG world map bg */
  .map-canvas svg.world {
    position: absolute;
    top: 0; left: 0;
    width: 100%;
    height: 100%;
  }

  /* Player pin */
  .pin {
    position: absolute;
    transform: translate(-50%, -100%);
    cursor: pointer;
    z-index: 10;
    transition: transform 0.15s, z-index 0s;
  }
  .pin:hover, .pin.active { transform: translate(-50%, -100%) scale(1.15); z-index: 50; }
  .pin-dot {
    width: 14px;
    height: 14px;
    border-radius: 50%;
    margin: 0 auto 2px;
    box-shadow: 0 0 8px;
    position: relative;
  }
  .pin-dot::after {
    content: '';
    position: absolute;
    bottom: -4px;
    left: 50%;
    transform: translateX(-50%);
    width: 0; height: 0;
    border-left: 4px solid transparent;
    border-right: 4px solid transparent;
  }
  .pin.ger .pin-dot { background: #dd0000; box-shadow: 0 0 10px rgba(221,0,0,0.5); }
  .pin.ger .pin-dot::after { border-top: 5px solid #dd0000; }
  .pin.usa .pin-dot { background: #002868; box-shadow: 0 0 10px rgba(0,40,104,0.5); }
  .pin.usa .pin-dot::after { border-top: 5px solid #002868; }
  .pin-label {
    font-size: 8px;
    font-weight: 700;
    color: #ccc;
    text-align: center;
    white-space: nowrap;
    text-shadow: 0 1px 3px #000, 0 0 6px #000;
    max-width: 80px;
    overflow: hidden;
    text-overflow: ellipsis;
  }
  .pin-count {
    font-size: 7px;
    color: #888;
    text-align: center;
  }

  /* Player card popup */
  .card-popup {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    z-index: 300;
    background: rgba(20, 24, 40, 0.97);
    backdrop-filter: blur(16px);
    border-top: 2px solid #2a2e42;
    padding: 16px;
    transform: translateY(100%);
    transition: transform 0.3s cubic-bezier(0.16, 1, 0.3, 1);
    max-height: 60vh;
    overflow-y: auto;
    border-radius: 16px 16px 0 0;
  }
  .card-popup.open { transform: translateY(0); }
  .card-popup .close-btn {
    position: absolute;
    top: 12px;
    right: 16px;
    font-size: 20px;
    cursor: pointer;
    color: #666;
    background: none;
    border: none;
  }
  .city-name {
    font-size: 18px;
    font-weight: 900;
    margin-bottom: 4px;
  }
  .city-club {
    font-size: 12px;
    color: #888;
    margin-bottom: 12px;
  }
  .player-cards {
    display: flex;
    gap: 10px;
    flex-wrap: wrap;
  }
  .p-card {
    background: linear-gradient(145deg, #1a1e32, #222640);
    border: 1px solid #333;
    border-radius: 10px;
    padding: 12px 14px;
    min-width: 140px;
    flex: 1;
    position: relative;
    overflow: hidden;
  }
  .p-card::before {
    content: '';
    position: absolute;
    top: 0; left: 0; right: 0;
    height: 3px;
  }
  .p-card.ger::before { background: linear-gradient(90deg, #000, #dd0000, #ffcc00); }
  .p-card.usa::before { background: linear-gradient(90deg, #002868, #fff, #bf0a30); }
  .p-card .p-num { font-size: 32px; font-weight: 900; opacity: 0.1; position: absolute; top: 6px; right: 10px; }
  .p-card .p-name { font-size: 14px; font-weight: 700; }
  .p-card .p-badge { color: #ffcc00; font-size: 10px; font-weight: 900; }
  .p-card .p-pos { font-size: 10px; color: #888; text-transform: uppercase; letter-spacing: 2px; margin-top: 2px; }
  .p-card .p-flag { font-size: 14px; margin-top: 4px; }

  /* Hint */
  .hint {
    position: fixed;
    bottom: 16px;
    left: 50%;
    transform: translateX(-50%);
    font-size: 10px;
    color: #444;
    z-index: 100;
    pointer-events: none;
    text-align: center;
  }
</style>
</head>
<body>

<div class="top-bar">
  <div class="score">üá∫üá∏ 2 ‚Äî 0 üá©üá™</div>
  <div class="toggle-pills">
    <button class="pill ger active" onclick="filter('ger')">üá©üá™</button>
    <button class="pill both" onclick="filter('both')">Both</button>
    <button class="pill usa" onclick="filter('usa')">üá∫üá∏</button>
  </div>
</div>

<div class="map-viewport" id="viewport">
  <div class="map-canvas" id="canvas">
    <svg class="world" viewBox="0 0 1400 800" xmlns="http://www.w3.org/2000/svg">
      <!-- North America -->
      <path d="M80,120 Q120,60 200,80 L320,90 Q400,70 460,100 L520,130 Q560,150 580,180 L600,220 Q590,260 560,300 L520,340 Q480,380 440,400 L380,390 Q320,380 260,360 L200,340 Q140,310 110,270 L90,220 Q70,180 80,140 Z" fill="#131830" stroke="#1e2445" stroke-width="1"/>
      <!-- Greenland -->
      <path d="M520,40 Q560,30 600,45 L620,70 Q610,90 590,100 L550,95 Q530,80 520,60 Z" fill="#131830" stroke="#1e2445" stroke-width="0.5"/>
      <!-- Europe -->
      <path d="M700,100 Q740,80 800,90 L870,100 Q920,90 960,100 L980,120 Q1000,140 990,170 L970,200 Q950,230 910,240 L860,235 Q820,230 790,220 L760,200 Q730,180 710,155 L700,130 Z" fill="#131830" stroke="#1e2445" stroke-width="1"/>
      <!-- Scandinavia -->
      <path d="M810,50 Q830,40 850,50 L870,70 Q880,90 870,100 L840,95 Q820,85 810,70 Z" fill="#131830" stroke="#1e2445" stroke-width="0.5"/>
      <!-- UK -->
      <path d="M720,120 Q730,110 740,115 L745,130 Q740,140 730,138 Z" fill="#131830" stroke="#1e2445" stroke-width="0.5"/>
      <!-- Text labels -->
      <text x="330" y="170" fill="#1a2040" font-size="22" font-weight="900" text-anchor="middle" font-family="Inter">NORTH AMERICA</text>
      <text x="850" y="155" fill="#1a2040" font-size="22" font-weight="900" text-anchor="middle" font-family="Inter">EUROPE</text>
      <!-- Water labels -->
      <text x="640" y="200" fill="#0e1225" font-size="14" font-weight="600" text-anchor="middle" font-family="Inter" letter-spacing="8">ATLANTIC</text>
    </svg>
  </div>
</div>

<div class="card-popup" id="popup">
  <button class="close-btn" onclick="closePopup()">‚úï</button>
  <div id="popup-content"></div>
</div>

<div class="hint" id="hint">scroll & pinch to explore ‚Ä¢ tap a pin to see players</div>

<script>
// City locations on the 1400x800 map
const cities = {
  // NHL North America
  "Seattle":       { x: 115, y: 155, full: "Seattle, WA" },
  "Edmonton":      { x: 175, y: 120, full: "Edmonton, AB" },
  "Calgary":       { x: 185, y: 135, full: "Calgary, AB" },
  "Vancouver":     { x: 130, y: 145, full: "Vancouver, BC" },
  "Winnipeg":      { x: 280, y: 145, full: "Winnipeg, MB" },
  "St. Paul":      { x: 310, y: 175, full: "St. Paul, MN" },
  "Chicago":       { x: 340, y: 195, full: "Chicago, IL" },
  "Detroit":       { x: 370, y: 190, full: "Detroit, MI" },
  "Columbus":      { x: 380, y: 200, full: "Columbus, OH" },
  "Buffalo":       { x: 410, y: 185, full: "Buffalo, NY" },
  "Ottawa":        { x: 430, y: 165, full: "Ottawa, ON" },
  "Toronto":       { x: 400, y: 180, full: "Toronto, ON" },
  "Boston":        { x: 450, y: 178, full: "Boston, MA" },
  "New York":      { x: 440, y: 195, full: "New York, NY" },
  "Newark":        { x: 438, y: 198, full: "Newark, NJ" },
  "Raleigh":       { x: 420, y: 230, full: "Raleigh, NC" },
  "Tampa":         { x: 400, y: 280, full: "Tampa, FL" },
  "Sunrise":       { x: 415, y: 290, full: "Sunrise, FL" },
  "Dallas":        { x: 280, y: 260, full: "Dallas, TX" },
  "Salt Lake City":{ x: 180, y: 200, full: "Salt Lake City, UT" },
  "Las Vegas":     { x: 155, y: 225, full: "Las Vegas, NV" },
  "San Jose":      { x: 110, y: 220, full: "San Jose, CA" },
  "Portland":      { x: 115, y: 165, full: "Portland, OR" },
  // DEL Germany
  "Munich":        { x: 835, y: 155, full: "Munich, Germany" },
  "Berlin":        { x: 845, y: 125, full: "Berlin, Germany" },
  "Mannheim":      { x: 810, y: 148, full: "Mannheim, Germany" },
  "Cologne":       { x: 795, y: 138, full: "Cologne, Germany" },
  "Nuremberg":     { x: 828, y: 148, full: "Nuremberg, Germany" },
  "Frankfurt":     { x: 812, y: 142, full: "Frankfurt, Germany" },
};

// Official IIHF rosters
const players = [
  // GERMANY - Goalies
  { name: "Philipp Grubauer", num: 30, pos: "G", team: "ger", club: "Seattle Kraken", city: "Seattle", league: "NHL" },
  { name: "Maximilian Franzreb", num: 37, pos: "G", team: "ger", club: "Adler Mannheim", city: "Mannheim", league: "DEL" },
  // GERMANY - Defense
  { name: "Moritz Seider", num: 53, pos: "D", team: "ger", badge: "A", club: "Detroit Red Wings", city: "Detroit", league: "NHL" },
  { name: "Fabio Wagner", num: 38, pos: "D", team: "ger", club: "EHC Red Bull M√ºnchen", city: "Munich", league: "DEL" },
  { name: "Kai Wissmann", num: 6, pos: "D", team: "ger", club: "Eisb√§ren Berlin", city: "Berlin", league: "DEL" },
  { name: "Jonas M√ºller", num: 41, pos: "D", team: "ger", club: "Eisb√§ren Berlin", city: "Berlin", league: "DEL" },
  { name: "Leon Gawanke", num: 9, pos: "D", team: "ger", club: "Winnipeg Jets", city: "Winnipeg", league: "NHL" },
  { name: "Lukas K√§lble", num: 49, pos: "D", team: "ger", club: "N√ºrnberg Ice Tigers", city: "Nuremberg", league: "DEL" },
  { name: "Moritz M√ºller", num: 91, pos: "D", team: "ger", club: "K√∂lner Haie", city: "Cologne", league: "DEL" },
  // GERMANY - Forwards
  { name: "Leon Draisaitl", num: 29, pos: "C", team: "ger", badge: "C", club: "Edmonton Oilers", city: "Edmonton", league: "NHL" },
  { name: "Tim St√ºtzle", num: 18, pos: "C", team: "ger", badge: "A", club: "Ottawa Senators", city: "Ottawa", league: "NHL" },
  { name: "Joshua Samanski", num: 44, pos: "F", team: "ger", club: "Portland Winterhawks", city: "Portland", league: "WHL" },
  { name: "Frederik Tiffels", num: 95, pos: "F", team: "ger", club: "K√∂lner Haie", city: "Cologne", league: "DEL" },
  { name: "Lukas Reichel", num: 73, pos: "F", team: "ger", club: "Chicago Blackhawks", city: "Chicago", league: "NHL" },
  { name: "John-Jason Peterka", num: 77, pos: "F", team: "ger", club: "Buffalo Sabres", city: "Buffalo", league: "NHL" },
  { name: "Parker Tuomie", num: 62, pos: "F", team: "ger", club: "EHC Red Bull M√ºnchen", city: "Munich", league: "DEL" },
  { name: "Marc Michaelis", num: 65, pos: "F", team: "ger", club: "Adler Mannheim", city: "Mannheim", league: "DEL" },
  { name: "Dominik Kahun", num: 72, pos: "F", team: "ger", club: "EHC Red Bull M√ºnchen", city: "Munich", league: "DEL" },
  { name: "Tobias Rieder", num: 8, pos: "F", team: "ger", club: "Adler Mannheim", city: "Mannheim", league: "DEL" },
  { name: "Alexander Ehl", num: 40, pos: "F", team: "ger", club: "L√∂wen Frankfurt", city: "Frankfurt", league: "DEL" },
  { name: "Nico Sturm", num: 78, pos: "F", team: "ger", club: "San Jose Sharks", city: "San Jose", league: "NHL" },

  // USA - Goalies
  { name: "Jake Oettinger", num: 30, pos: "G", team: "usa", club: "Dallas Stars", city: "Dallas", league: "NHL" },
  { name: "Connor Hellebuyck", num: 37, pos: "G", team: "usa", club: "Winnipeg Jets", city: "Winnipeg", league: "NHL" },
  // USA - Defense
  { name: "Charlie McAvoy", num: 25, pos: "D", team: "usa", badge: "A", club: "Boston Bruins", city: "Boston", league: "NHL" },
  { name: "Quinn Hughes", num: 43, pos: "D", team: "usa", club: "Vancouver Canucks", city: "Vancouver", league: "NHL" },
  { name: "Brock Faber", num: 14, pos: "D", team: "usa", club: "Minnesota Wild", city: "St. Paul", league: "NHL" },
  { name: "Jaccob Slavin", num: 74, pos: "D", team: "usa", club: "Carolina Hurricanes", city: "Raleigh", league: "NHL" },
  { name: "Jake Sanderson", num: 8, pos: "D", team: "usa", club: "Ottawa Senators", city: "Ottawa", league: "NHL" },
  { name: "Zach Werenski", num: 85, pos: "D", team: "usa", club: "Columbus Blue Jackets", city: "Columbus", league: "NHL" },
  { name: "Noah Hanifin", num: 15, pos: "D", team: "usa", club: "Vegas Golden Knights", city: "Las Vegas", league: "NHL" },
  // USA - Forwards
  { name: "Auston Matthews", num: 34, pos: "C", team: "usa", badge: "C", club: "Toronto Maple Leafs", city: "Toronto", league: "NHL" },
  { name: "Jack Eichel", num: 9, pos: "C", team: "usa", club: "Vegas Golden Knights", city: "Las Vegas", league: "NHL" },
  { name: "Matthew Tkachuk", num: 19, pos: "F", team: "usa", badge: "A", club: "Florida Panthers", city: "Sunrise", league: "NHL" },
  { name: "Brady Tkachuk", num: 7, pos: "F", team: "usa", club: "Ottawa Senators", city: "Ottawa", league: "NHL" },
  { name: "Matt Boldy", num: 12, pos: "F", team: "usa", club: "Minnesota Wild", city: "St. Paul", league: "NHL" },
  { name: "Jake Guentzel", num: 59, pos: "F", team: "usa", club: "Tampa Bay Lightning", city: "Tampa", league: "NHL" },
  { name: "Dylan Larkin", num: 21, pos: "C", team: "usa", club: "Detroit Red Wings", city: "Detroit", league: "NHL" },
  { name: "Tage Thompson", num: 72, pos: "C", team: "usa", club: "Buffalo Sabres", city: "Buffalo", league: "NHL" },
  { name: "Clayton Keller", num: 91, pos: "F", team: "usa", club: "Utah Hockey Club", city: "Salt Lake City", league: "NHL" },
  { name: "J.T. Miller", num: 10, pos: "F", team: "usa", club: "Vancouver Canucks", city: "Vancouver", league: "NHL" },
  { name: "Brock Nelson", num: 29, pos: "F", team: "usa", club: "New York Islanders", city: "New York", league: "NHL" },
  { name: "Jack Hughes", num: 86, pos: "C", team: "usa", club: "New Jersey Devils", city: "Newark", league: "NHL" },
  { name: "Vincent Trocheck", num: 16, pos: "C", team: "usa", club: "New York Rangers", city: "New York", league: "NHL" },
];

let currentFilter = 'ger';
const canvas = document.getElementById('canvas');
const popup = document.getElementById('popup');

function groupByCity(filterTeam) {
  const groups = {};
  players.forEach(p => {
    if (filterTeam !== 'both' && p.team !== filterTeam) return;
    if (!cities[p.city]) return;
    if (!groups[p.city]) groups[p.city] = { players: [], city: p.city };
    groups[p.city].players.push(p);
  });
  return groups;
}

function renderPins() {
  // Clear existing pins
  document.querySelectorAll('.pin').forEach(el => el.remove());

  const groups = groupByCity(currentFilter);
  Object.entries(groups).forEach(([cityName, group]) => {
    const c = cities[cityName];
    if (!c) return;

    const pin = document.createElement('div');
    const mainTeam = group.players[0].team;
    const hasBoth = group.players.some(p => p.team === 'ger') && group.players.some(p => p.team === 'usa');
    pin.className = `pin ${hasBoth ? 'usa' : mainTeam}`;
    pin.style.left = c.x + 'px';
    pin.style.top = c.y + 'px';

    const count = group.players.length;
    const size = 10 + count * 3;
    const names = group.players.map(p => p.name.split(' ').pop()).slice(0, 3).join(', ') + (count > 3 ? '‚Ä¶' : '');

    pin.innerHTML = `
      <div class="pin-dot" style="width:${size}px;height:${size}px;${hasBoth ? 'background:linear-gradient(135deg,#dd0000,#002868);box-shadow:0 0 10px rgba(100,0,100,0.5)' : ''}"></div>
      <div class="pin-label">${cityName}</div>
      <div class="pin-count">${count} player${count > 1 ? 's' : ''}</div>
    `;

    pin.addEventListener('click', () => openPopup(cityName, group));
    canvas.appendChild(pin);
  });
}

function openPopup(cityName, group) {
  const c = cities[cityName];
  const clubs = [...new Set(group.players.map(p => p.club))];

  let cardsHtml = group.players.map(p => `
    <div class="p-card ${p.team}">
      <div class="p-num">#${p.num}</div>
      <div class="p-flag">${p.team === 'ger' ? 'üá©üá™' : 'üá∫üá∏'}</div>
      <div class="p-name">${p.badge ? `<span class="p-badge">${p.badge}</span> ` : ''}${p.name}</div>
      <div class="p-pos">#${p.num} ‚Ä¢ ${p.pos} ‚Ä¢ ${p.league}</div>
    </div>
  `).join('');

  document.getElementById('popup-content').innerHTML = `
    <div class="city-name">${c.full}</div>
    <div class="city-club">${clubs.join(' ‚Ä¢ ')}</div>
    <div class="player-cards">${cardsHtml}</div>
  `;

  popup.classList.add('open');
  document.getElementById('hint').style.display = 'none';
}

function closePopup() {
  popup.classList.remove('open');
}

function filter(team) {
  currentFilter = team;
  document.querySelectorAll('.pill').forEach(p => p.classList.remove('active'));
  document.querySelector(`.pill.${team}`).classList.add('active');
  renderPins();
  closePopup();
}

// Close popup on map tap
canvas.addEventListener('click', (e) => {
  if (!e.target.closest('.pin')) closePopup();
});

// Initial render ‚Äî scroll to show both continents
renderPins();

// Center the view on load (show Europe + NA)
const viewport = document.getElementById('viewport');
setTimeout(() => {
  viewport.scrollLeft = 0;
  viewport.scrollTop = 50;
}, 100);
</script>
</body>
</html>
